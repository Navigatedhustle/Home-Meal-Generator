{% extends 'base.html' %}{% block content %}<div class='grid grid-cols-1 lg:grid-cols-2 gap-6'><form method='post' action='{{ url_for('generate') }}' class='rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-6 shadow-xl'><h2 class='text-lg font-semibold'>Your Inputs</h2><p class='text-sm text-slate-400'>Enter TDEE directly or compute from stats. Target is set to <span class='font-semibold text-indigo-300'>−25%</span> for weight loss.</p><div class='grid grid-cols-2 gap-4 mt-4'><label class='block'><span class='text-sm'>TDEE (kcal)</span><input name='tdee' type='number' step='1' placeholder='2400' class='input'></label><label class='block'><span class='text-sm'>Days</span><select name='days' class='input'>{% for d in range(1,8) %}<option value='{{d}}'>{{d}}</option>{% endfor %}</select></label><label class='block'><span class='text-sm'>Meals/day</span><select name='meals_per_day' class='input'>{% for m in [2,3,4,5] %}<option value='{{m}}' {% if m==3 %}selected{% endif %}>{{m}}</option>{% endfor %}</select></label></div><h3 class='mt-6 font-semibold'>Or compute from stats</h3><div class='grid grid-cols-2 gap-4 mt-2'><label class='block'><span class='text-sm'>Sex</span><select name='sex' class='input'><option value='male'>Male</option><option value='female'>Female</option></select></label><label class='block'><span class='text-sm'>Age</span><input name='age' type='number' step='1' placeholder='27' class='input'></label><div class='col-span-2'><span class='text-sm'>Height</span><div class='flex gap-2'><input name='height_ft' type='number' placeholder='ft' class='input w-24'><input name='height_in' type='number' placeholder='in' class='input w-24'><input name='height_cm' type='number' placeholder='cm (optional)' class='input w-40'></div><p class='text-xs text-slate-400 mt-1'>We’ll convert feet+inches to cm automatically.</p></div><label class='block'><span class='text-sm'>Weight (lb)</span><input name='weight_lb' type='number' step='0.1' placeholder='180' class='input'></label><label class='block'><span class='text-sm'>Activity</span><select name='activity' class='input'>{% for k,v in activities.items() %}<option value='{{k}}'>{{k.title()}}</option>{% endfor %}</select></label></div><p class='text-xs text-slate-400 mt-1'>Prefer metric? You can use height_cm/weight_kg.</p><h3 class='mt-6 font-semibold'>Preferences</h3><div class='grid grid-cols-2 gap-2 text-sm'><label><input type='checkbox' name='vegetarian'> Vegetarian</label><label><input type='checkbox' name='vegan'> Vegan</label><label><input type='checkbox' name='dairy_free'> Dairy‑free</label><label><input type='checkbox' name='gluten_free'> Gluten‑free</label></div><label class='block mt-2'><span class='text-sm'>Exclusions (comma-separated)</span><input name='excludes' class='input' placeholder='tuna, peanut'></label><div class='flex items-center gap-3 mt-6'><button class='btn-primary' type='submit'>Generate Plan</button><a class='btn-ghost' href='{{ url_for('index') }}'>Reset</a></div><p class='text-xs text-slate-400 mt-2'>One-click PDF export will appear with your plan.</p></form><section class='rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-6 shadow-xl'><h2 class='text-lg font-semibold'>What you get</h2><ul class='mt-2 space-y-2 text-sm text-slate-300'><li>• Daily plan ~<span class='font-semibold'>75%</span> of TDEE (±5%)</li><li>• Balanced macro targets auto-calculated</li><li>• <span class='font-semibold'>450+ meals</span> across diet styles & calories</li><li>• Per‑meal step‑by‑step instructions</li><li>• Smart grocery list aggregation</li><li>• <span class='font-semibold'>PDF export</span> for clients</li></ul><div class='mt-4 p-4 rounded-xl bg-gradient-to-br from-indigo-500/10 via-cyan-500/10 to-emerald-500/10 border border-white/10'><p class='text-slate-300 text-sm'>Tip: For maximum variety, leave exclusions empty on your first run, then refine.</p></div></section></div>{% if result %}<section class='rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-6 shadow-xl mt-6'><div class='flex items-center gap-3 justify-between'><h2 class='text-lg font-semibold'>Your Plan</h2><a class='btn-primary' href='{{ url_for('pdf', token=result.token) }}'>Download PDF</a></div><div class='flex flex-wrap gap-2 mt-3 text-xs'><span class='chip'>TDEE: {{ result.tdee }} kcal</span><span class='chip'>Target: {{ result.target_kcal }} kcal/day</span><span class='chip'>Meals/day: {{ result.meals_per_day }}</span><span class='chip'>Days: {{ result.days }}</span><span class='chip'>Macros/day: {{ result.p_g }}P / {{ result.c_g }}C / {{ result.f_g }}F</span></div>{% for day in result.plan %}<div class='mt-6'><h3 class='font-semibold text-slate-100'>Day {{ loop.index }} <span class='text-slate-400'>(~{{ result.day_totals[loop.index0] }} kcal)</span></h3><div class='grid md:grid-cols-2 gap-3 mt-2'>{% for meal in day %}<div class='rounded-xl border border-white/10 bg-slate-900/50 p-4'><div class='flex items-center justify-between'><div><p class='font-semibold'>{{ meal.name }}</p><p class='text-xs text-slate-400'>{{ meal.meal_type.title() }} • {{ meal.K }} kcal • {{ meal.P }}P / {{ meal.C }}C / {{ meal.F }}F</p></div></div>{% if meal.instructions %}<details class='mt-2'><summary class='text-xs text-slate-400 cursor-pointer'>Steps</summary><ol class='list-decimal ml-4 mt-1 text-sm space-y-1'>{% for step in meal.instructions %}<li>{{ step }}</li>{% endfor %}</ol></details>{% endif %}</div>{% endfor %}</div></div>{% endfor %}<h3 class='font-semibold text-slate-100 mt-6'>Grocery List</h3><div class='grid sm:grid-cols-2 lg:grid-cols-3 gap-2 mt-2 text-sm'>{% for item, qty in result.grocery.items() %}<div class='rounded-lg border border-white/10 bg-slate-900/50 p-3'>• {{ item }} <span class='text-slate-400'>x{{ qty }}</span></div>{% endfor %}</div></section>{% endif %}{% endblock %}